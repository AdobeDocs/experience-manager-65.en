---
title: Mitigating Log4j2 vulnerabilities for Experience Manager Forms
description: Mitigating Log4j2 vulnerabilities for Experience Manager Forms
content-type: reference
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: Security
geptopics: SG_AEMFORMS/categories/jee
role: Admin
solution: Experience Manager, Experience Manager Forms
feature: Adaptive Forms
---
# Mitigating Log4j2 vulnerabilities for Experience Manager Forms

## Issue

Critical security vulnerabilities have been reported for Apache Log4j2, a popular logging library for Java-based applications. The following vulnerabilities have been analyzed:

<table border="1">
  <tr>
    <th>Vulnerability</th>
    <th>What's impacted</th>
    <th>What's not impacted?</th>
    <th>Status</th>
  </tr>
  <tr>
    <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-44228">CVE-2021-44228</a></td>
    <td rowspan="2">
      <ul>
        <li>Experience Manager 6.5 Forms on JEE (all versions from 6.5 GA to 6.5.11)</li>
        <li>Experience Manager 6.4 Forms on JEE (all versions from 6.4 GA to 6.4.8)</li>
        <li>Experience Manager 6.3 Forms on JEE (all versions from 6.3 GA to 6.3.3)</li>
        <li>Experience Manager 6.5 Forms Designer</li>
        <li>Experience Manager 6.4 Forms Designer</li>
        <li>Automated Forms Conversion Service</li>
      </ul>
    </td>
    <td rowspan="2">
      <ul>
        <li>Experience Manager Forms Workbench (all versions)</li>
        <li>Experience Manager Forms on OSGi (all versions)</li>
      </ul>
    </td>
    <td rowspan="2">
      These have been fixed. See the <strong>Resolution</strong> section for fixes and mitigation steps.
    </td>
  </tr>
  <tr>
    <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-45046">CVE-2021-45046</a></td>
  </tr>
  <tr>
    <td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105">CVE-2021-45105</a></td>
    <td rowspan="9" colspan="2">
      No impact on any Experience Manager Forms release for out-of-the-box logging configurations. If you have any additional logging configurations, check these configurations for these vulnerabilities.
    </td>
  </tr>
  <tr><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-44832">CVE-2021-44832</a></td><td></td></tr>
  <tr><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-4104">CVE-2021-4104</a></td><td></td></tr>
  <tr><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22963">CVE-2022-22963</a></td><td></td></tr>
  <tr><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965">CVE-2022-22965</a></td><td></td></tr>
  <tr><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9488">CVE-2020-9488</a></td><td></td></tr>
  <tr><td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23302">CVE-2022-23307</a></td><td></td></tr>
</table>

>[!NOTE]
> 
> AEM 6.5.13.0 Forms and earlier releases includes both Log4j libraries (1.x and 2.17.1). The AEM Forms Log4j 1.x libraries in AEM 6.5.13.0 Forms and earlier releases are not part of the vulnerability reported nor are they noted as vulnerable in AEM Forms code scans performed by Adobe. However, all Log4j 1.x library are removed in the 6.5.14 release. For instructions to install AEM 6.5.14.0 or a later release, see [release notes](https://experienceleague.adobe.com/en/docs/experience-manager-65/content/release-notes/release-notes).

## Resolution

You can use one of the following methods to mitigate the risk of this vulnerability:

* Install the latest service pack
* Use manual mitigation steps 

**Install the latest service pack**

>[!CAUTION]
> 
> If you have applied a hotfix on the Experience Manager Forms Service Pack 6.3.3.8 or Experience Manager Forms Service Pack 6.4.8.4 environment, do not install the service pack with the vulnerabilities fixes (listed below). Installing these service packs may overwrite the hotfix. Adobe recommends using **manual mitigation steps** in such a scenario.

<table border="1" cellpadding="8" cellspacing="0">
  <thead>
    <tr>
      <th>Release</th>
      <th>Version</th>
      <th>Download link/User action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Experience Manager 6.5 Forms on JEE</td>
      <td>AEMForms-6.5.0-0038 (log4jv2.16)</td>
      <td rowspan="5">Download from <a href="https://auth.services.adobe.com/en_US/index.html?callback=https%3A%2F%2Fims-na1.adobelogin.com%2Fims%2Fadobeid%2Fexc_app%2FAdobeID%2Ftoken%3Fredirect_uri%3Dhttps%253A%252F%252Fexperience.adobe.com%252F%2523old_hash%253Dold_hash%253D%252523%25252Fdownloads%2526from_ims%253Dtrue%253Fclient_id%253Dexc_app%2526api%253Dauthorize%2526scope%253Dab.manage%252Caccount_cluster.read%252Cadditional_info%252Cadditional_info.job_function%252Cadditional_info.projectedProductContext%252Cadditional_info.roles%252CAdobeID%252Cadobeio.appregistry.read%252Cadobeio_api%252Caudiencemanager_api%252Ccreative_cloud%252Cmps%252Copenid%252Corg.read%252Cpps.read%252Cread_organizations%252Cread_pc%252Cread_pc.acp%252Cread_pc.dma_tartan%252Csession%26state%3D%257B%2522jslibver%2522%253A%2522v2-v0.31.0-2-g1e8a8a8%2522%252C%2522nonce%2522%253A%25223811059492261787%2522%257D%26code_challenge_method%3Dplain%26use_ms_for_expiry%3Dtrue&client_id=exc_app&scope=ab.manage%2Caccount_cluster.read%2Cadditional_info%2Cadditional_info.job_function%2Cadditional_info.projectedProductContext%2Cadditional_info.roles%2CAdobeID%2Cadobeio.appregistry.read%2Cadobeio_api%2Caudiencemanager_api%2Ccreative_cloud%2Cmps%2Copenid%2Corg.read%2Cpps.read%2Cread_organizations%2Cread_pc%2Cread_pc.acp%2Cread_pc.dma_tartan%2Csession&state=%7B%22jslibver%22%3A%22v2-v0.31.0-2-g1e8a8a8%22%2C%22nonce%22%3A%223811059492261787%22%7D&relay=2cf36844-ac87-4b40-a6fe-9a06cd0a01b8&locale=en_US&flow_type=token&dctx_id=v%3A2%2Cs%2Cf%2Cb8e64530-b013-11ee-a6c1-e721bdec0171&idp_flow_type=login&response_type=token&profile_filter=%7B%22findFirst%22%3Atrue%2C+%22fallbackToAA%22%3Atrue%2C+%22preferForwardProfile%22%3Atrue%2C+%22searchEntireCluster%22%3Afalse%7D%3B+hasPC%28%22dma_tartan%22%29&code_challenge_method=plain&redirect_uri=https%3A%2F%2Fexperience.adobe.com%2F%23old_hash%3Dold_hash%3D%2523%252Fdownloads%26from_ims%3Dtrue%3Fclient_id%3Dexc_app%26api%3Dauthorize%26scope%3Dab.manage%2Caccount_cluster.read%2Cadditional_info%2Cadditional_info.job_function%2Cadditional_info.projectedProductContext%2Cadditional_info.roles%2CAdobeID%2Cadobeio.appregistry.read%2Cadobeio_api%2Caudiencemanager_api%2Ccreative_cloud%2Cmps%2Copenid%2Corg.read%2Cpps.read%2Cread_organizations%2Cread_pc%2Cread_pc.acp%2Cread_pc.dma_tartan%2Csession&use_ms_for_expiry=true#/">Software Distribution</a>.</td>
    </tr>
    <tr>
      <td>Experience Manager 6.4 Forms on JEE</td>
      <td>AEMForms-6.4.0-0027</td>
    </tr>
    <tr>
      <td>Experience Manager 6.3 Forms on JEE</td>
      <td>AEMForms-6.3.0-0047</td>
    </tr>
    <tr>
      <td>Experience Manager 6.5 Forms Designer</td>
      <td>AEM Forms Designer v650.019</td>
    </tr>
    <tr>
      <td>Experience Manager 6.4 Forms Designer</td>
      <td>AEM Forms Designer v640.012</td>
    </tr>
    <tr>
      <td>Automated Forms Conversion Service</td>
      <td>The mitigation steps were identified and the service was patched.</td>
      <td>There is no user action.</td>
    </tr>
  </tbody>
</table>

## Use manual mitigation steps

To mitigate the issue, for Experience Manager 6.5 Forms (log4j-core version 2.10 and later), Experience Manager 6.4 Forms (log4j-core version earlier than 2.10), and Experience Manager 6.3 Forms (log4j-core version earlier than 2.10), perform the following steps: 

1. Shut down all the server instances and locators.

1. Remove `org/apache/logging/log4j/core/lookup/JndiLookup.class` from the vulnerable `log4j-core-2.xx.jar` available at the following locations:

    * **Deployable EAR:** 

    ```javascript
    <FORMS_INSTALLATION_DIRECTORY>/configurationManager/export/adobe-livecycle-[jboss|weblogic|websphere].ear
    ```
    
    * **GemFire or Geode locator:** 

    ```javascript
    <FORMS_INSTALLATION_DIRECTORY>/lib/caching/lib
    ```

    To update Deployable EAR, depending on your operating system, you can use one of the following methods to remove the `JndiLookup.class` from the vulnerable `log4j-core-2.xx.jar`:

    * (Linux with Oracle WebLogic or Redhat JBoss): Run the following command. Update the `version` and application server information before running these commands:

    ```javascript
    unzip adobe-livecycle-<weblogic|jboss>.ear lib/log4j-core-<version>.jar
    ```

    ```javascript
    zip -d lib/log4j-core-xxx.jar org/apache/logging/log4j/core/lookup/JndiLookup.  class
    ```
  
    ```javascript
    zip -ru adobe-livecycle-jboss.ear lib/log4j-core-<version>.jar
    ```

    * (Linux with IBM WebSphere): Run the following command. Update the `version` and application server information before running these commands:

    ```javascript
    unzip adobe-livecycle-websphere.ear log4j-core-<version>.jar
    ```
 
    ```javascript
    zip -d log4j-core-xxx.jar org/apache/logging/log4j/core/lookup/JndiLookup.class
    ```
    
    * (Microsoft Windows): Use a GUI tool like [7-Zip](https://www.7-zip.org/) to remove the class file.  
1. Repeat step 2 for each application server instance (node) and all locators (if more than one). 

1. After updating the jar, redeploy the modified EAR and restart all locator processes and server instances.

>[!NOTE]
> 
> * Replace the original copy of the log4j-core-2.xx jar with the updated copy. No other changes are required.
> * When the configuration manager is run again, contents of `<FORMS_INSTALLATION_DIRECTORY/configurationManager/export` can be overwritten.   To avoid redoing the above change each time this happens, update the jar in `<FORMS_INSTALLATION_DIRECTORY>/deploy/adobe-core-[jboss|weblogic|websphere].ear`. This ensures that the `adobe-livecycle-[jboss|weblogic|websphere].ear` produced by configuration manager already has the updated `log4j-core-2.xx jar`.
> * Manual modifications to deployable artifacts can be overwritten on patching/upgrade. If this happens, reapply the procedure. 

## References

[https://logging.apache.org/log4j/2.x/security.html](https://logging.apache.org/security.html)

**Who should I contact if I have additional questions or any issues in performing mitigation steps?**

You can contact [Adobe Support](https://experienceleague.adobe.com/?lang=en&support-solution=Experience+Manager#support) or raise a [support ticket](https://experienceleague.adobe.com/en/docs/customer-one/using/home#submit-ticket).

**Who should I contact if I have additional questions or any issues in performing mitigation steps?**
[Legal Notices](https://helpx.adobe.com/legal/legal-notices.html)    |    [Online Privacy Policy](https://www.adobe.com/privacy.html)
