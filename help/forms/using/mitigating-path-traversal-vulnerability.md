---
title: Mitigating Path traversal vulnerability in functional web frameworks for AEM Forms on JEE
description: Mitigating Path traversal vulnerability in functional web frameworks for AEM Forms on JEE
content-type: reference
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: Security
geptopics: SG_AEMFORMS/categories/jee
role: Admin
solution: Experience Manager, Experience Manager Forms
feature: Adaptive Forms
---

# Mitigating Path traversal vulnerability in functional web frameworks for AEM Forms on JEE

## Overview

Applications serving static resources through the functional web frameworks WebMvc.fn or WebFlux.fn are vulnerable to path traversal attacks. This document outlines the steps and procedures for mitigating the vulnerability in functional web frameworks.

## Vulnerability Impact Analysis

### Affected Components

- **Impacted**: Experience Manager 6.5 Forms on JEE (versions 6.5 GA to 6.5.22.0)
- **Not Impacted**:
  - Experience Manager Forms Workbench
  - Experience Manager Forms on OSGi
  - Experience Manager Forms as a Cloud Service

### Specific Vulnerability

- **CVE-2023-50164**: CVE-2024-38819: Path traversal vulnerability in functional web frameworks

## Resolution Options

### Version-Specific Solutions

| AEM Forms Version | Required Action |
|-------------------|-----------------|
| 6.5.22.0 | [Install the hot fix] |
| 6.5.17.0 - 6.5.21.0 | Use manual mitigation steps |
| 6.5 - 6.5.16.0 | Install latest service pack 6.5.23.0 or later|

> **Note**: AEM Forms provides support for last 6 service packs. Users with older versions should upgrade to latest service pack and install the hot fix. 

## Manual Mitigation Steps

1. Stop the Application servers.
1. Stop and locator servers.
1. Remove Spring JARs from Core EAR:
   1. Navigate to `[Adobe_Experience_Manager_Forms installation directory]/deploy`. 
   1. Open the `adobe-core-<appserver>.ear` file using an archive manager tool. Where `<appserver>` can be JBoss, WebLogic, or WebSphere, depending on your environment: 
   - **For JBoss:** Navigate to the `ear/lib` folder and delete the following JAR files:
         - `spring-core-<version>.jar`
         - `spring-web-<version>.jar`
   
   - **For WebLogic or WebSphere:** Delete the following JAR files from the root of the EAR:
         - `spring-core-<version>.jar`
         - `spring-web-<version>.jar`
   
   - **For all application servers:** At the root level of the `adobe-core-<appserver>.ear`, open the `adobe-dscf.jar` file and edit the `META-INF/MANIFEST.MF` file to remove any references to the following JAR files:
         - `spring-core-<version>.jar`
         - `spring-web-<version>.jar`

1. Replace JAR Files from Geode distribution:
   1. Navigate to `<Adobe_Experience_Manager_Forms>/lib/caching/lib`
   1. Replace the existing JAR files with the updated versions:
     - `spring-context-<version>.jar` → `spring-context-6.1.14.jar`
     - `spring-beans-<version>.jar` → `spring-beans-6.1.14.jar`
     - `spring-core-<version>.jar` → `spring-core-6.1.14.jar`
     - `spring-jcl-<version>.jar` → `spring-jcl-6.1.14.jar`
     - `spring-web-<version>.jar` → `spring-web-6.1.14.jar`

     To get the newer JAR files, download the spring-6.1.14-jars.zip file from [Adobe Software Distribution](https://experience.adobe.com/#/downloads/content/software-distribution/en/aem.html?package=/content/software-distribution/en/details.html/content/dam/aem/public/adobe/packages/cq650/hotfix/aem-6-5-0-hotfix-vuln-30727/spring-6.1.14-jars.zip) and extract the ZIP file to access the updated Spring framework JAR files.

   1. Update the MANIFEST.MF files in the following JAR files:
     - `geode-server-all-<version>.jar`
     - `gfsh-dependencies.jar`
     
     For each JAR:
     - Open the JAR using an archive manager tool
     - Locate and extract the `META-INF/MANIFEST.MF` file
     - Edit the MANIFEST.MF file in a text editor
     - Find the "Class-Path" section and update all Spring framework references:
       - `spring-core-<version>.jar` to `spring-core-6.1.14.jar`
       - `spring-web-<version>.jar` to `spring-web-6.1.14.jar`
       - `spring-context-<version>.jar` to `spring-context-6.1.14.jar`
       - `spring-beans-<version>.jar` to `spring-beans-6.1.14.jar`
       - `spring-jcl-<version>.jar` to `spring-jcl-6.1.14.jar`
     - Save the modified MANIFEST.MF file
     - Replace the original MANIFEST.MF in the JAR with your updated version
     - Save the JAR file

   1. Common Issues to Watch For:
      - Ensure no duplicate entries in the manifest
      - Maintain proper line endings
      - Keep the manifest file size under 65535 bytes
      - Verify all referenced JARs exist in the specified locations

   1. Verification Steps:
      - Check if the manifest is properly updated
      - Verify all Spring dependencies are correctly referenced
      - Ensure no old version references remain
      - Test the application to confirm no class loading issues

1. Run the Configuration Manager. 

1. Restart Servers:
   - Start the Locator Servers using JDK 17
   - Start the Application Servers using the same JDK version (JDK 8 or JDK 11) that was previously used. 


## Additional Resources

- [AEM Forms Release Notes](https://experienceleague.adobe.com/docs/experience-manager-65/release-notes/release-notes.html)
- [Software Distribution Portal](https://experience.adobe.com/#/downloads/content/software-distribution/en/aem.html)